<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carte avec Points Manuels et Codes</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            font-family: Arial, sans-serif;
        }
        #map {
            height: 100%;
            width: 100%;
        }
        #code {
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 10px;
            border-radius: 5px;
            display: none;
        }
    </style>
</head>
<body>
    <div id="map"></div>
    <div id="code">Codes secrets : <span id="codeText"></span></div>

    <script>
        let map;
        let userMarker;

        const locations = [
        { lat: 49.84523, lng: 3.31073, code: 'Combien de joueurs par équipe sont sur la glace en même temps (hors gardien et remplaçant) au hockey ?' },
        { lat: 49.8436, lng: 3.3069, code: 'Comment s’appelle la zone cible avec des cercles concentriques au curling ?' },
        { lat: 49.84538, lng: 3.30999, code: 'Quelle est la différence principale entre slalom et slalom géant en ski alpin ?' },
        { lat: 49.84323, lng: 3.30589, code: 'Quel est le principe du biathlon (deux disciplines combinées) ?' },
        { lat: 49.84277, lng: 3.30407, code: 'Quelle est la différence entre programme court et programme libre en patinage ?' },
        { lat: 49.84804, lng: 3.31628, code: 'Qu’appelle-t-on une “porte” sur un parcours de ski alpin ?' }, 
        { lat: 49.84549, lng: 3.3105, code: 'À quoi sert le balayage devant la pierre au curling ?' },
        { lat: 49.84273, lng: 3.30518, code: 'À quoi sert la mise en jeu (“engagement”) au hockey ?' },
        { lat: 49.84769, lng: 3.31543, code: 'Que se passe-t-il quand un athlète rate une cible selon l’épreuve au biathlon ?' },
        { lat: 49.84495, lng: 3.3098, code: 'Que juge-t-on en patinage artistique (2 grandes familles de critères) ?' },
        { lat: 49.84699, lng: 3.31501, code: 'Quel format est généralement le plus rapide en ski alpin : descente ou super-G ?' },
        { lat: 49.84257, lng: 3.30456, code: 'Combien de pierres une équipe lance-t-elle par “end” au curling ?' },
        { lat: 49.84662, lng: 3.31439, code: 'Quelle est la règle simple du hors-jeu au hockey ?' },
        { lat: 49.8443, lng: 3.30858, code: 'Combien de cibles y a-t-il sur un tir couché ou debout au biathlon (classique) ?' },
        { lat: 49.84376, lng: 3.30633, code: 'Cite 3 éléments possibles en patinage artistique (exemples).' },
        { lat: 49.84535, lng: 3.31111, code: 'Quelle discipline a le plus de virages courts et serrés en ski alpin ?' },
        { lat: 49.84713, lng: 3.31383, code: 'Comment marque-t-on des points à la fin d’un end au curling ?' },
        { lat: 49.84288, lng: 3.3046, code: 'Qu’est-ce qu’une pénalité et quelle conséquence immédiate elle peut avoir au hockey ?' },
        { lat: 49.8445, lng: 3.30833, code: 'Pourquoi dit-on que le biathlon demande une forte gestion du stress ?' },
        { lat: 49.84736, lng: 3.31368, code: 'Pourquoi la musique et l’interprétation comptent-elles en patinage ?' },
        { lat: 49.84323, lng: 3.30632, code: 'Sur quoi se joue beaucoup la performance en ski alpin (2 facteurs) ?' },
        { lat: 49.848, lng: 3.31546, code: 'Quel est l’objectif tactique principal au curling : protection, placement, ou puissance ?' },
        { lat: 49.84458, lng: 3.31007, code: 'Quel est le rôle spécifique du gardien au hockey ?' },
        { lat: 49.84347, lng: 3.30694, code: 'Quel matériel de tir est utilisé aux JO (type d’arme) en biathlon ?' },
        { lat: 49.84756, lng: 3.31425, code: 'Qu’est-ce qu’une rotation (spin) et à quoi sert-elle dans le score au patinage?' },
        { lat: 49.84485, lng: 3.31071, code: 'Qu’est-ce que le combiné (ou “combiné alpin”) en ski alpin ?' },
        { lat: 49.84331, lng: 3.30543, code: 'Que signifie “hammer” (marteau) dans un match de curling ?' },
        { lat: 49.84635, lng: 3.31154, code: 'Quelles sont les 3 périodes d’un match (durée standard) au hockey ?' },
        { lat: 49.84299, lng: 3.30495, code: 'Quelles sont les 2 positions de tir les plus fréquentes au biathlon?' },
        { lat: 49.84819, lng: 3.31519, code: 'Pourquoi l’équilibre et la vitesse sont-ils essentiels pour les sauts en patinage ?' },
        { lat: 49.84318, lng: 3.30503, code: 'Pourquoi le slalom est-il considéré comme très technique au ski alpin ?' },
        { lat: 49.84393, lng: 3.3075, code: 'À quoi sert le “take-out” au curling ?' },
        { lat: 49.84672, lng: 3.314, code: 'Quelle surface spécifique entoure la glace et sert aux rebonds au hockey ?' },
        { lat: 49.84407, lng: 3.30709, code: 'Quel est l’enjeu principal du tir au biathlon : précision, vitesse, ou les deux ?' },
        { lat: 49.8476, lng: 3.31582, code: 'À quoi sert une séquence de pas au patinage ?' },
        { lat: 49.84495, lng: 3.30907, code: 'C’est quoi un “DNF” dans les résultats du ski alpin ?' },
        { lat: 49.84349, lng: 3.3075, code: 'Quelle est la différence entre une “guard” et un “draw” au curling ?' },
        { lat: 49.84737, lng: 3.31393, code: 'Comment gagne-t-on un match en phase à élimination directe si égalité au Hockey ?' },
        { lat: 49.84346, lng: 3.30611, code: 'Quelle est la logique d’une course poursuite (pursuit) au biathlon ?' },
        { lat: 49.84638, lng: 3.31408, code: 'Quel type de patin utilise-t-on au patinage (lame : particularité générale) ?' },
        { lat: 49.84399, lng: 3.30806, code: 'Quels équipements de sécurité sont importants au ski alpin (2 exemples) ?' },
        { lat: 49.84687, lng: 3.31233, code: 'Pourquoi le curling est souvent comparé à un jeu d’échecs sur glace ?' },
        { lat: 49.84391, lng: 3.30904, code: 'Quel sport d’hiver olympique est le plus “contact” dans l’esprit du grand public au hockey ?' },
        { lat: 49.84267, lng: 3.3045, code: 'Comment s’appelle la partie “course” du biathlon ?' },
        { lat: 49.84686, lng: 3.31467, code: 'Quelle est la différence entre un saut simple, double, triple, quadruple en patinage ?' },
        { lat: 49.84696, lng: 3.31448, code: 'Pourquoi l’état de la neige change la course en ski alpin ?' },
        { lat: 49.84417, lng: 3.3096, code: 'Quelle est la fonction du “skip” (capitaine) au curling ?' },
        { lat: 49.84739, lng: 3.31556, code: 'Quelle est la zone derrière les cages souvent utilisée pour construire le jeu au hockey ?' },
        { lat: 49.84562, lng: 3.31156, code: 'Pourquoi le rythme cardiaque est un enjeu au moment du tir en biathlon ?' },
        { lat: 49.84715, lng: 3.31295, code: 'Qu’est-ce qu’un “caractère” ou thème de programme au patinage, et pourquoi ça aide ?' },
            

        
        ];

        function initMap() {
            map = new google.maps.Map(document.getElementById('map'), {
                zoom: 18,
                center: locations[0], // Centre de la carte sur le premier point
                mapTypeId: 'roadmap'
            });

            addMarkersAndCircles(locations);

            if (navigator.geolocation) {
                navigator.geolocation.watchPosition(showPosition, showError, { enableHighAccuracy: true });
            } else {
                alert("La géolocalisation n'est pas supportée par ce navigateur.");
            }
        }

        function addMarkersAndCircles(locations) {
            locations.forEach((location) => {
                // Ajouter un marqueur pour chaque emplacement
                new google.maps.Marker({
                    position: location,
                    map: map
                });

                // Ajouter un cercle de 2 mètres de rayon pour chaque emplacement
                location.circle = new google.maps.Circle({
                    strokeColor: '#FF0000',
                    strokeOpacity: 0.8,
                    strokeWeight: 2,
                    fillColor: '#FF0000',
                    fillOpacity: 0.35,
                    map: map,
                    center: location,
                    radius: 5 // 2 mètres
                });
            });
        }

        function showPosition(position) {
            const userCoords = {
                lat: position.coords.latitude,
                lng: position.coords.longitude
            };

            if (!userMarker) {
                userMarker = new google.maps.Marker({
                    position: userCoords,
                    map: map,
                    title: "Votre position"
                });
            } else {
                userMarker.setPosition(userCoords);
            }

            map.setCenter(userCoords);

            let codes = [];

            locations.forEach((location) => {
                const distance = google.maps.geometry.spherical.computeDistanceBetween(
                    new google.maps.LatLng(userCoords.lat, userCoords.lng),
                    location.circle.getCenter()
                );

                if (distance <= location.circle.getRadius()) {
                    codes.push(location.code);
                }
            });

            if (codes.length > 0) {
                document.getElementById('codeText').innerText = codes.join(', ');
                document.getElementById('code').style.display = 'block';
            } else {
                document.getElementById('code').style.display = 'none';
            }

            updatePosition(userCoords);
        }

        function showError(error) {
            switch(error.code) {
                case error.PERMISSION_DENIED:
                    alert("L'utilisateur a refusé la demande de géolocalisation.");
                    break;
                case error.POSITION_UNAVAILABLE:
                    alert("Les informations de localisation ne sont pas disponibles.");
                    break;
                case error.TIMEOUT:
                    alert("La demande de localisation a expiré.");
                    break;
                case error.UNKNOWN_ERROR:
                    alert("Une erreur inconnue est survenue.");
                    break;
            }
        }

        function updatePosition(position) {
            // Fonction pour mettre à jour la position de l'utilisateur dans la base de données
            // Par exemple, ici vous pouvez envoyer les nouvelles coordonnées à votre serveur
            console.log("Position mise à jour : ", position);
        }
    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDt2I0f_PeVvfRj7MaIO2V_17hBeovo8OE&libraries=geometry&callback=initMap" async defer></script>
</body>
</html>
